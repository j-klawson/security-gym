campaign:
  name: "Post-Auth Command Execution Only"
  description: >
    Single-phase post-authentication campaign against Isildur.
    Logs in with known credentials and executes system profiling commands,
    generating syslog/journal entries for post-auth feature activation
    (auth_success_count, session_duration, other_event_count).
    MITRE T1059.004 (TA0002 Execution).
  seed: 42

  target:
    host: 192.168.2.201
    ssh_user: researcher
    ssh_key: ~/.ssh/isildur_research
    ssh_port: 22

  phases:
    - name: "Post-Auth Execution"
      module: ssh_post_auth
      mitre_technique: "T1059.004"
      mitre_tactic: "TA0002"
      attack_type: execution
      attack_stage: execution
      severity: 3
      params:
        username: researcher
        password: "pass123"
        command_profile: system_profiler
        target_port: 22
        inter_command_delay_ms: [500, 3000]
      ip_source:
        strategy: aliased
        count: 3
        subnet: "192.168.2.0/24"
        start_offset: 120
        interface: en0
      timing:
        duration_seconds: 180
        profile: constant
        jitter_ms: [2000, 5000]

  collection:
    log_sources:
      - name: auth_log
        parser: auth_log
        remote_path: /var/log/auth.log
      - name: syslog
        parser: syslog
        remote_path: /var/log/syslog
      - name: journal
        parser: journal
        remote_command: "journalctl --since '1 hour ago' -o json"
      - name: auditd
        parser: auditd
        remote_command: "sudo -n ausearch -k research_exploit --raw"
    output:
      db_path: data/campaigns.db
      time_buffer_seconds: 60
